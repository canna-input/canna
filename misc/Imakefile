/* $Id: Imakefile,v 1.2 2002/10/20 18:00:21 aida_s Exp $ */
#include "../Canna.conf"

CANNAROOT = ..

#define IHaveSubdirs
#define PassCDebugFlags

#ifdef engineSwitch
       PROGRAMS = engine.cf default.canna
           SRCS = engine.cpp
#else
       PROGRAMS = default.canna
#endif
#ifdef nec
        DEFINES = $(SCRIPTS_DEFINES) -DLIBCANNADIR=$(libCannaDir) \
                  -DCPP=$(CPP) -DCANNA_DSOREV=$(cannaDsoRev) -Unec
#else
        DEFINES = $(SCRIPTS_DEFINES) -DLIBCANNADIR=$(libCannaDir) \
		  -DCPP=$(CPP) -DCANNA_DSOREV=$(cannaDsoRev)
#endif

SUBDIRS =initfiles

AllTarget($(PROGRAMS))

#ifdef engineSwitch
CppScriptTarget(engine.cf,engine.cpp,$(DEFINES),/**/)
InstallNonExec(engine.cf,$(cannaLibDir))
#endif

MakeSubdirs($(SUBDIRS))
DependSubdirs($(SUBDIRS))
MakeLintLibSubdirs($(SUBDIRS))
MakeLintSubdirs($(SUBDIRS),install.ln,install.ln)

MakeDirectories(install,$(cannaLibDir)/sample/src)
#if defined(nec_ews_svr4) || defined(pcux_r32)
InstallNamedNonExec(rMakefile,Makefile,$(cannaLibDir)/sample/src)
#else
InstallNamedNonExec(cMakefile,Makefile,$(cannaLibDir)/sample/src)
#endif /* nec_ews_svr4 */

#ifdef USE_OBSOLETE_STYLE_FILENAME
default.canna: default.ca
	sed 's/\.cbp/\.kp/' < default.ca > default.canna
#else
default.canna: default.ca
	$(CP) default.ca default.canna
#endif

InstallNonExec(default.canna,$(cannaLibDir))
InstallNonExec(is.c,$(cannaLibDir)/sample/src)

clean::
	$(RM) $(PROGRAMS)

DependDependency()
